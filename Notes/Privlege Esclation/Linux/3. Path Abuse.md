`PATH` is the list of directories a shell or process searches when you run a program by name (e.g. `foo` → search `/usr/bin`, `/bin`, `/usr/local/bin`, ...).

**Path abuse** happens when a privileged process or script invokes a command **by filename only** (no absolute path) and one of the directories in that process’s `PATH` is writable by an untrusted user. An attacker can drop a malicious executable of the same name into that writable directory and get it executed with higher privileges.

---
#### 1. Check the PATH variable

```shell-session
echo $PATH
```

![[Pasted image 20251002163141.png]]

---
#### 2. Add the current directory in the path

```shell-session
htb_student@NIX02:~$ PATH=.:${PATH}
htb_student@NIX02:~$ export PATH
htb_student@NIX02:~$ echo $PATH

.:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games
```

![[Pasted image 20251002163856.png]]
![[Pasted image 20251002163918.png]]

---
#### 3. write a script for a command which the target might run
we modify the path to run a simple `echo` command when the command `ls` is typed.

```shell-session
htb_student@NIX02:~$ touch ls
htb_student@NIX02:~$ echo 'echo "PATH ABUSE!!"' > ls
htb_student@NIX02:~$ chmod +x ls
```

![[Pasted image 20251002164300.png]]

---
#### 4. When the target runs our command, our script will get updated
![[Pasted image 20251002164347.png]]
