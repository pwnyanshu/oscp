Helper scripts (such as [LinEnum](https://github.com/rebootuser/LinEnum)) is available still we should know to do manual enum

Here goes the ENUM list

---
#### OS Version (Public exploits)
```shell-session
cat /etc/os-release
```
is it old and not maintained we may find CVEs

---
#### Kernel version (Public exploits)
```shell-session
uname -a
```
see if we have some public exploit PoC for this version

---
#### Running services
Misconfigured Services, Public exploit PoCs exist for many of them
A misconfigured or vulnerable service running as root can be an easy win for privilege escalation
```shell-session
ps aux | grep root
```

---
#### Installed Packages and Versions
It is important to check for any out-of-date or vulnerable packages that may be easily leveraged for privilege escalation.
![[Pasted image 20251002114407.png]]

---
#### Logged in Users
Knowing which other users are logged into the system and what they are doing can give greater into possible local lateral movement and privilege escalation paths.
```shell-session
ps au
```

---
#### User Home Directories for other users
User home folders may also contain SSH keys that can be used to access other systems or scripts and configuration files containing credentials. 
Common to find files with creds.
```shell-session
ls /home
```

We can check individual user directories and check to see if files such as the `.bash_history` file are readable and contain any interesting commands, look for configuration files, and check to see if we can obtain copies of a user's SSH keys.

```shell-session
-la /home/stacey.jenkins/
```

If you find an SSH key for your current user, this could be used to open an SSH session on the host (if SSH is exposed externally) and gain a stable and fully interactive session. SSH keys could be leveraged to access other systems within the network as well. At the minimum, check the ARP cache to see what other hosts are being accessed and cross-reference these against any useable SSH private keys.


---
#### SSH Directory Contents
```shell-session
ls -l ~/.ssh
```
---

#### Bash History
It is also important to check a user's bash history, as they may be passing passwords as an argument on the command line, working with git repositories, setting up cron jobs, and more. Reviewing what the user has been doing can give you considerable insight into the type of server you land on and give a hint as to privilege escalation paths.

```shell-session
history
```

---
#### Sudo Privileges
Can the user run any commands either as another user or as root? If you do not have credentials for the user, it may not be possible to leverage sudo permissions. However, often sudoer entries include `NOPASSWD`, meaning that the user can run the specified command without being prompted for a password. Not all commands, even we can run as root, will lead to privilege escalation. It is not uncommon to gain access as a user with full sudo privileges, meaning they can run any command as root. Issuing a simple `sudo su` command will immediately give you a root session.

```shell-session
sudo -l
```

---
#### Configuration Files
Configuration files can hold a wealth of information. It is worth searching through all files that end in extensions such as `.conf` and `.config`, for usernames, passwords, and other secrets.

---
#### Readable Shadow File
If the shadow file is readable, you will be able to gather password hashes for all users who have a password set. While this does not guarantee further access, these hashes can be subjected to an offline brute-force attack to recover the cleartext password.

---
#### Password Hashes in /etc/passwd
Occasionally, you will see password hashes directly in the /etc/passwd file. This file is readable by all users, and as with hashes in the `shadow` file, these can be subjected to an offline password cracking attack. This configuration, while not common, can sometimes be seen on embedded devices and routers.
```shell-session
cat /etc/passwd
```

---
#### Cron Jobs
Cron jobs on Linux systems are similar to Windows scheduled tasks. They are often set up to perform maintenance and backup tasks. In conjunction with other misconfigurations such as relative paths or weak permissions, they can leverage to escalate privileges when the scheduled cron job runs.
```shell-session
ls -la /etc/cron.daily/
```

---
#### Unmounted File Systems and Additional Drives
If you discover and can mount an additional drive or unmounted file system, you may find sensitive files, passwords, or backups that can be leveraged to escalate privileges.
```shell-session
lsblk
```

---
#### SETUID and SETGID Permissions
Binaries are set with these permissions to allow a user to run a command as root, without having to grant root-level access to the user. Many binaries contain functionality that can be exploited to get a root shell.

---
#### Writeable Directories
You may discover a writeable directory where a cron job places files, which provides an idea of how often the cron job runs and could be used to elevate privileges if the script that the cron job runs is also writeable.
```shell-session
find / -path /proc -prune -o -type d -perm -o+w 2>/dev/null
```

---
#### Writeable Files
Are any scripts or configuration files world-writable? While altering configuration files can be extremely destructive, there may be instances where a minor modification can open up further access. Also, any scripts that are run as root using cron jobs can be modified slightly to append a command.
```shell-session
find / -path /proc -prune -o -type f -perm -o+w 2>/dev/null
```
