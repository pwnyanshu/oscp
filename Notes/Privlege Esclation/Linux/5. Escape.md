
****1. Command injection**  
What: Inject extra commands into an allowed command’s arguments.  
Example: `ls -l \`pwd``→ runs`pwd `via backticks. How to do it: Find a permitted builtin/command that accepts user-controlled args and insert backticks/`$( )` or metacharacters.  
Mitigation: Sanitize inputs; disallow meta-characters; avoid passing untrusted strings to a shell.

**2. Command substitution (backticks / $( ))**  
What: Shell evaluates `$(cmd)` or `` `cmd` `` before the main command runs.  
Example: `some_allowed_command $(whoami)`  
How to do it: Wrap the command you want executed in `$( )` or backticks when supplying arguments.  
Mitigation: Strip/validate `$( )` and backticks from user input; run programs without invoking a shell.

**3. Command chaining / metacharacters**  
What: Use `;`, `&&`, `||`, `|` to run extra commands in the same line.  
Example: `ls -l; /bin/sh` or `allowed_cmd && /bin/sh`  
How to do it: Append `; id` or `&& /bin/sh` to any allowed command string.  
Mitigation: Remove/block metacharacters from inputs; use execve-style calls.

**4. Environment variable abuse**  
What: Change env vars (PATH, LD_PRELOAD, LD_LIBRARY_PATH, etc.) to influence exec behavior.  
Example: `PATH=.:$PATH; ls` after placing a malicious `ls` in `.`  
How to do it: Export or prefix env vars before running allowed commands or set them in files the service reads.  
Mitigation: Run with a sanitized environment (`env -i`), reset PATH, and drop privileges.

**5. Shell functions / aliases**  
What: Define a function/alias that runs forbidden commands, then call it.  
Example: `f(){ /bin/sh; }; f`  
How to do it: If the restricted shell still allows `function` or `()` syntax, create a function that executes `/bin/sh`.  
Mitigation: Disallow user init files; block function/alias definitions in the restricted profile.

**6. Abusing helpers/binaries**  
What: Use allowed binaries that let you run commands (e.g., editors, less, find, xargs, awk, perl, python).  
Example: `awk 'BEGIN {system("/bin/sh")}'` or `python -c 'import os; os.system("/bin/sh")'`  
How to do it: Look for installed interpreters or tools accessible in the restricted environment and call their exec features.  
Mitigation: Whitelist safe commands only; remove dangerous utilities or restrict where they can read/write.

**7. File/option parsing tricks (wildcards & -- options)**  
What: Create filenames that are parsed as options (e.g., `--checkpoint-action=exec=...`) or abuse `*` expansion.  
Example: `touch --checkpoint-action=exec=sh root.sh` and cron runs `tar *` → executes `root.sh`.  
How to do it: Place specially-named files in a directory where a privileged cron uses wildcards.  
Mitigation: Use `--` before filenames (e.g., `tar -- -czf ...`), avoid running wildcards in privileged contexts.**